<section class="row c-squirrel">
    <div class="col-xs-12 text-center">
        <h2 translate="SQUIRREL_HEADING"></h2>
    </div>
    <div class="col-xs-12 col-md-8 col-md-offset-2">
        <!-- form to be a squirrel -->
        <form name="squirrelForm" ng-submit="vm.submit()" novalidate>
            <!-- price -->
            <section class="row c-squirrel-intro">
                <div class="col-xs-12 text-center">
                    <p translate="SQUIRREL_INTRO_ONE"></p>
                    <div class="row">
                        <div class="col-xs-8 col-md-4 col-md-offset-4">
                            <div class="input-group input-group-lg">
                                <input type="number" class="form-control" min="1" ng-change="vm.priceChanged()" ng-model="vm.price">
                                <span class="input-group-addon" id="basic-addon2">€</span>
                            </div>
                        </div>
                    </div>
                    <p translate="SQUIRREL_INTRO_TWO"></p>
                </div>
                <div class="col-xs-12 col-md-10 col-md-offset-1">
                    <div class="row c-squirrel-spread">
                        <div class="col-xs-3 c-squirrel-spread__title">{{ 'SQUIRREL_SLIDER_SOCIETY' | translate }}</div>
                        <div class="col-xs-8 c-squirrel-spread__slider">
                            <input ng-model="vm.priceSociety" ng-change="vm.shareWithBge()" type="number" min="1"  slider options="vm.optionsSociety" />
                        </div>
                        <div class="col-xs-1 c-squirrel-spread__amount">{{vm.priceSociety}}€</div>
                    </div>
                    <div class="row c-squirrel-spread">
                        <div class="col-xs-3 c-squirrel-spread__title">{{ 'SQUIRREL_SLIDER_BGE' | translate }}</div>
                        <div class="col-xs-8 c-squirrel-spread__slider">
                            <input ng-model="vm.priceBge" ng-change="vm.shareWithSociety()" type="number" min="0"  slider options="vm.optionsBge" />
                        </div>
                        <div class="col-xs-1 c-squirrel-spread__amount">{{vm.priceBge}}€</div>
                    </div>
                </div>
            </section>
            <!-- info -->
            <section class="row">
                <div class="col-xs-12 text-center">
                    <!-- replace the popover with modals if the content is to long -->
                    <p>
                        {{'SQUIRREL_INFO_HOW' | translate}}
                        <a href="#" ng-click="vm.showHow()">{{'SQUIRREL_INFO_HOW_LINK' | translate }}</a>
                    </p>
                    <p>
                        {{'SQUIRREL_INFO_WHY' | translate}}
                        <a href="#" ng-click="vm.showWhy()">{{ 'SQUIRREL_INFO_WHY_LINK' | translate }}</a>
                    </p>

                </div>
            </section>
            <!-- bank account -->
            <section class="row" ng-show="vm.formState.show">
                <div class="col-xs-12 text-left">
                    <!-- name and lastname -->
                    <div class="row">
                        <div class="col-xs-12 col-md-6">
                            <div class="form-group"  ng-class="{ 'has-error' : squirrelForm.firstName.$invalid && !squirrelForm.firstName.$pristine && squirrelForm.firstName.$dirty, 'has-warning' : squirrelForm.$dirty }">
                                <label for="firstName">{{ 'FORM_NAME_LABEL' | translate }}</label>
                                <input type="text"
                                       name="firstName"
                                       ng-model="vm.user.name"
                                       id="firstName"
                                       ng-minlength="2"
                                       ng-maxlength="30"
                                       placeholder="{{ 'FORM_NAME_PLACEHOLDER' | translate }}"
                                       required class="form-control">
                                <div ng-messages="squirrelForm.firstName.$error" ng-if="squirrelForm.firstName.$dirty || squirrelForm.$dirty">
                                    <div class="help-block" ng-message="required">{{ 'VALIDATION_REQUIRED' | translate }}</div>
                                    <div class="help-block" ng-message="minlength"><span translate="VALIDATION_MIN" translate-value-length="2"></span></div>
                                    <div class="help-block" ng-message="maxlength"><span translate="VALIDATION_MAX" translate-value-length="30"></span></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 col-md-6">
                            <div class="form-group"  ng-class="{ 'has-error' : squirrelForm.lastName.$invalid && !squirrelForm.lastName.$pristine && squirrelForm.lastName.$dirty, 'has-warning' : squirrelForm.$dirty }">
                                <label for="lastName">{{ 'FORM_NAME_LAST_LABEL' | translate }}</label>
                                <input type="text"
                                       name="lastName"
                                       id="lastName"
                                       ng-model="vm.user.lastName"
                                       ng-minlength="2"
                                       ng-maxlength="30"
                                       placeholder="{{ 'FORM_NAME_LAST_PLACEHOLDER' | translate }}"
                                       required class="form-control">
                                <div ng-messages="squirrelForm.lastName.$error" ng-if="squirrelForm.lastName.$dirty || squirrelForm.$dirty">
                                    <div class="help-block" ng-message="required">{{ 'VALIDATION_REQUIRED' | translate }}</div>
                                    <div class="help-block" ng-message="minlength"><span translate="VALIDATION_MIN" translate-value-length="2"></span></div>
                                    <div class="help-block" ng-message="maxlength"><span translate="VALIDATION_MAX" translate-value-length="30"></span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- email -->
                    <div class="row">
                        <!-- user email if he is not logged in -->
                        <div ng-hide="vm.auth.user" class="col-xs-12">
                            <div class="row">
                                <div class="col-xs-12 col-md-6">
                                    <div class="form-group"  ng-class="{ 'has-error' : squirrelForm.email.$invalid && !squirrelForm.email.$pristine && squirrelForm.email.$dirty, 'has-warning' : squirrelForm.$dirty }">
                                        <label for="email">{{ 'FORM_EMAIL_LABEL' | translate }}</label>
                                        <input type="email"
                                               name="email"
                                               id="email"
                                               ng-model="vm.user.email"
                                               placeholder="{{ 'FORM_EMAIL_PLACEHOLDER' | translate }}"
                                               ng-required="{{ !vm.auth.user }}"
                                               class="form-control">
                                        <div ng-messages="squirrelForm.email.$error || squirrelForm.$dirty">
                                            <div class="help-block" ng-message="required">{{ 'VALIDATION_REQUIRED' | translate }}</div>
                                            <div class="help-block" ng-message="email"><span translate="VALIDATION_EMAIL"></span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- street and number -->
                    <div class="row">
                        <div class="col-xs-12 col-md-8">
                            <div class="form-group"  ng-class="{ 'has-error' : squirrelForm.street.$invalid && !squirrelForm.street.$pristine && squirrelForm.street.$dirty, 'has-warning' : squirrelForm.$dirty }">
                                <label for="street">{{ 'FORM_STREET_LABEL' | translate }}</label>
                                <input type="text"
                                       name="street"
                                       ng-model="vm.user.address.street"
                                       id="street"
                                       ng-minlength="2"
                                       ng-maxlength="30"
                                       placeholder="{{ 'FORM_STREET_PLACEHOLDER' | translate }}"
                                       required class="form-control">
                                <div ng-messages="squirrelForm.street.$error" ng-if="squirrelForm.street.$dirty || squirrelForm.$dirty">
                                    <div class="help-block" ng-message="required">{{ 'VALIDATION_REQUIRED' | translate }}</div>
                                    <div class="help-block" ng-message="minlength"><span translate="VALIDATION_MIN" translate-value-length="2"></span></div>
                                    <div class="help-block" ng-message="maxlength"><span translate="VALIDATION_MAX" translate-value-length="30"></span></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 col-md-4">
                            <div class="form-group"  ng-class="{ 'has-error' : squirrelForm.streetNumber.$invalid && !squirrelForm.streetNumber.$pristine && squirrelForm.streetNumber.$dirty, 'has-warning' : squirrelForm.$dirty }">
                                <label for=streetNumber>{{ 'FORM_STREET_NUMBER_LABEL' | translate }}</label>
                                <input type="text"
                                       name="streetNumber"
                                       ng-model="vm.user.address.streetNumber"
                                       id="streetNumber"
                                       ng-minlength="1"
                                       ng-maxlength="10"
                                       placeholder="{{ 'FORM_STREET_NUMBER_PLACEHOLDER' | translate }}"
                                       required class="form-control">
                                <div ng-messages="squirrelForm.streetNumber.$error" ng-if="squirrelForm.streetNumber.$dirty || squirrelForm.$dirty">
                                    <div class="help-block" ng-message="required">{{ 'VALIDATION_REQUIRED' | translate }}</div>
                                    <div class="help-block" ng-message="minlength"><span translate="VALIDATION_MIN" translate-value-length="2"></span></div>
                                    <div class="help-block" ng-message="maxlength"><span translate="VALIDATION_MAX" translate-value-length="30"></span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- bank name and bic -->
                    <div class="row">
                        <div class="col-xs-12 col-md-8">
                            <div class="form-group"  ng-class="{ 'has-error' : squirrelForm.bank.$invalid && !squirrelForm.bank.$pristine && squirrelForm.bank.$dirty, 'has-warning' : squirrelForm.$dirty }">
                                <label for="bank">{{ 'FORM_BANK_LABEL' | translate }}</label>
                                <input type="text"
                                       name="bank"
                                       ng-model="vm.user.bank.name"
                                       id="bank"
                                       ng-minlength="3"
                                       ng-maxlength="40"
                                       placeholder="{{ 'FORM_BANK_PLACEHOLDER' | translate }}"
                                       required class="form-control">
                                <div ng-messages="squirrelForm.bank.$error" ng-if="squirrelForm.bank.$dirty || squirrelForm.$dirty">
                                    <div class="help-block" ng-message="required">{{ 'VALIDATION_REQUIRED' | translate }}</div>
                                    <div class="help-block" ng-message="minlength"><span translate="VALIDATION_MIN" translate-value-length="3"></span></div>
                                    <div class="help-block" ng-message="maxlength"><span translate="VALIDATION_MAX" translate-value-length="40"></span></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 col-md-4">
                            <div class="form-group"  ng-class="{ 'has-error' : squirrelForm.bic.$invalid && !squirrelForm.bic.$pristine && squirrelForm.bic.$dirty}">
                                <label for="bic">{{ 'FORM_BIC_LABEL' | translate }}</label>
                                <input type="text"
                                       name="bic"
                                       ng-model="vm.user.bank.bic"
                                       id="bic"
                                       ng-minlength="8"
                                       ng-maxlength="11"
                                       ng-pattern="'([a-zA-Z]{4}[a-zA-Z]{2}[a-zA-Z0-9]{2}([a-zA-Z0-9]{3})?)'"
                                       placeholder="{{ 'FORM_BIC_PLACEHOLDER' | translate }}"
                                       class="form-control">
                                <div ng-messages="squirrelForm.bic.$error" ng-if="squirrelForm.bic.$dirty || squirrelForm.$dirty">
                                    <div class="help-block" ng-message="minlength"><span translate="VALIDATION_MIN" translate-value-length="8"></span></div>
                                    <div class="help-block" ng-message="maxlength"><span translate="VALIDATION_MAX" translate-value-length="11"></span></div>
                                    <div class="help-block" ng-message="pattern"><span translate="VALIDATION_BIC"></span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- iban -->
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="form-group"  ng-class="{ 'has-error' : squirrelForm.iban.$invalid && !squirrelForm.iban.$pristine && squirrelForm.iban.$dirty, 'has-warning' : squirrelForm.$dirty }">
                                <label for="iban">{{ 'FORM_IBAN_LABEL' | translate }} <a href="http://www.iban-rechner.de/" target="_blank"> (IBAN berechnen)</a></label>
                                <input type="text"
                                       name="iban"
                                       ng-model="vm.user.bank.iban"
                                       id="iban"
                                       ng-iban
                                       placeholder="{{ 'FORM_IBAN_PLACEHOLDER' | translate }}"
                                       required class="form-control">
                                <div ng-messages="squirrelForm.iban.$error" ng-if="squirrelForm.iban.$dirty || squirrelForm.$dirty">
                                    <div class="help-block" ng-message="required">{{ 'VALIDATION_REQUIRED' | translate }}</div>
                                    <div class="help-block" ng-message="iban"><span translate="VALIDATION_IBAN"></span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- accept -->
                    <div class="row">
                        <div class="col-xs-12 col-md-8 col-md-offset-2">
                            <div class="checkbox" ng-class="{ 'has-error' : squirrelForm.accept.$invalid && !squirrelForm.accept.$pristine && squirrelForm.accept.$dirty, 'has-warning' : squirrelForm.$dirty }">
                                <label>
                                    <input type="checkbox" ng-model="vm.payment.accept" name="accept" check-required> <span translate="SQUIRREL_ACCEPT" translate-value-price="{{vm.price}}"></span>
                                    <div ng-messages="squirrelForm.accept.$error" ng-if="squirrelForm.accept.$dirty || squirrelForm.$dirty" >
                                        <div class="help-block" ng-message="checkRequired">{{ 'VALIDATION_CHECKED' | translate }}</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <!-- submit -->
                    <div class="row">
                        <div class="col-xs-12 text-center">
                            <button type="submit"  class="btn btn-large btn-bge">{{ 'SQUIRREL_SUBMIT' | translate }}</button>
                        </div>
                    </div>
                </div>
            </section>
            <!-- messages -->
            <section class="row">
                <alert ng-show="vm.formState.response.show" type="success">{{ 'SQUIRREL_SUCCESS' | translate }}</alert>
                <alert ng-show="vm.formState.progress.show" type="info">{{ 'SQUIRREL_PROGRESS' | translate }}</alert>
            </section>
        </form>
    </div>
    <script type="text/ng-template" id="squirrel/modal-how.html">
        <div class="modal-header">
            <h3 class="modal-title">{{ 'SQUIRREL_HOW_MODAL_TITLE' | translate }}</h3>
        </div>
        <div class="modal-body">
            <p>
                {{ 'SQUIRREL_HOW_MODAL_CONTENT' | translate }}
            </p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok()">OK</button>
        </div>
    </script>
    <script type="text/ng-template" id="squirrel/modal-why.html">
        <div class="modal-header">
            <h3 class="modal-title">{{ 'SQUIRREL_WHY_MODAL_TITLE' | translate }}</h3>
        </div>
        <div class="modal-body">
            <p>
                {{ 'SQUIRREL_WHY_MODAL_CONTENT' | translate }}
            </p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok()">OK</button>
        </div>
    </script>
</section>